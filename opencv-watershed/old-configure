#!/bin/sh

# Check for OpenCV
PKG_OK=$(pkg-config --exists opencv4 && echo "yes" || echo "no")
if [ "$PKG_OK" = "no" ]; then
  echo "Error: OpenCV not found. Please install OpenCV."
  exit 1
fi

# Generate Makefile
cat <<EOL > Makefile
CXX = g++
CXXFLAGS = \$(shell pkg-config --cflags opencv4)
LDFLAGS = \$(shell pkg-config --libs opencv4)
SRC = watershed/cv2-watershed.cpp
OBJ = \$(SRC:.cpp=.o)
TARGET = watershed/cv2-watershed

all: \$(TARGET)

\$(TARGET): \$(OBJ)
    \$(CXX) \$(OBJ) -o \$@ \$(LDFLAGS)

%.o: %.cpp
    \$(CXX) \$(CXXFLAGS) -c \$< -o \$@

clean:
    rm -f \$(OBJ) \$(TARGET)

.PHONY: all clean
EOL

echo "Configuration complete. You can now run 'make' to build the project."
